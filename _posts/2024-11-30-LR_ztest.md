---
layout: post
title: "[통계] Testing equality of coefficients from two different regressions"
categories: project
tags: test
last_modified_at: 2024-11-30T18:00:00~23:00
---  



## Testing equality of coeeficients from two different regresssions

정신이 없다. 어떻게든 결과를 내기 위해서 고군분투 중이다. 지금부터 설명할 식이 아마도 내가 해결하고자 하는 문제 (조건에 따라 서로 다른 효과를 보이는 eQTL을 어떻게 식별할 수 있을지)의 두 번째 열쇠가 될 거 같아 정리를 해보려고 한다.

[링크](https://stats.stackexchange.com/questions/93540/testing-equality-of-coefficients-from-two-different-regressions)   

위 링크를 해석 및 정리하였다.  

---  

## 해석본 - 질문  

아마도 이것은 기초적인 문제일 것으로 보이지만, 저는 제가 실질적으로 두 개의 다른 회귀 (regression) 식으로부터 온 회귀 계수 (coefficient)의 동일성 (equality)를 어떻게 실질적으로 평가하는지를 잘 모른다는 것을 깨달았습니다.  

이것을 해결하는데 길을 밝혀주실 누군가가 있을까요?  

더 구체적으로, 저는 아래와 같이 두 개의 regression 식을 제안합니다.  

1: y1 = (X1 * Beta1) + e1  
2: y2 = (X2 * Beta2) + e2  

여기서 X1은 regression 식 i의 design matrix를 의미하고, Beta1은 regression 식 i의 coefficient vector를 의미합니다. X1과 X2가, 차원의 수를 포함하여 잠재적으로 매우 다르다는 것을 저는 강조합니다.  

저는 여기서 beta1의 추정값과 beta2의 추정값이 같은지 다른지를 확인하는 것에 관심이 있습니다. 


본인 의견 : 즉 eQTL을 계산하기 위한 linear regression 식을 만든다면, X1은 SNP genotype 데이터가 들어가서 유전자 발현을 예측 (y1과 y2)한다는 의미이다. 여기서 y1은 조건 1에서의 SNP genotype 별 유전자 발현 예측값이 되겠고, y2는 조건 2에서의 SNP genotype 별 유전자 발현 예측값이 될 것이다. beta값은 결국 genotype의 차이에 따른 eQTL의 effect가 될 것이다.  

만약에 이것들이 같은 종류 (예를 들면 같은 조건에서의 데이터가 input으로 들어간)의 regression 식에서 나온 것이라면, 이건 사소한 일일 것입니다. 그러나 만약 어떤 하나가 다른 하나와 다른 종류 혹은 조건에서 나온 것이라면, 저는 어떻게 해야 할 지 잘 모르겠습니다. 누구라도 관련 아이디어를 저에게 제공해주실 수 있나요?   

... 이하 생략 ...  

---  

## 해석본 - 답변  

흔한 분석은 아니지만 정말 흥미롭네요. fair하지 않을 수도 있지만 합리적이고 잘 accept 되고 있는 기술을 제공할려고 합니다. 이 접근법은 Z-test로부터 옵니다.  

Z = (beta1 - beta2) / root((SEbeta1)^2 + (SEbeta2)^2)  

이 방정식은 Clogg, C. C., Petkova, E., & Haritou, A. (1995). Statistical methods for comparing regression coefficients between models. American Journal of Sociology, 100(5), 1261-1293. 에서 제공되었고,  Paternoster, R., Brame, R., Mazerolle, P., & Piquero, A. (1998). Using the correct statistical test for equality of regression coefficients. Criminology, 36(4), 859-866. 에 의해 인용되었습니다.  

---  

이후 이 답변이 많은 수의 추천을 받았고, 실제 impact factor가 높은 저널지의 연구자들도 이 식을 활용하는 것을 확인했다. 하지만 본인의 통계적인 지식이 부족했기 때문에 이것이 과연 합당한 방법인가에 대한 생각이 계속 들었고, 따라서 위 논문들을 읽어보기로 했다.  
