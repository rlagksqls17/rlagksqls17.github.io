---
layout: post
title: "WMS sequencing tech 2- QC와 트리밍"
categories: project
tags: test
last_modified_at: 2024-05-17T08:00:00~18:00
---


### 0. QC와 트리밍 개요  

QC는 Quality Control의 줄임말로, 이 QC과정을 거쳐 sequencing data 품질을 평가하고, 또한 트리밍 (trimming)이라는 과정을 통해 해당 데이터의 품질을 개선한다.  

---  

### 1. sequence data에서 quality란?

언뜻 보기에는 sequence data에 quality란게 어디 있다는 건지 감을 잡기 힘들 수도 있다. 보통 sequence data라 함은 3'-AGCGGCCCC-5'와 같이, 연구자가 PCR (polymerase chain reaction)로 증폭시킨 DNA 라이브러리 내 각각의 리드를, 시퀀싱 기계를 통해 읽어 내고 난 뒤의 데이터를 말한다.  

일루미나 사의 NGS sequencing을 예로 들어 더 자세히 설명하자면, 이렇게 PCR로 증폭시킨 각각의 리드들이 담긴 DNA 라이브러리가 있다고 가정해보자. 각각의 리드에 대해서 서열을 읽기 위해, 형광을 붙인 dNTP (deoxynucleotide)를 "흘려" 보낸다. 흘려보낸 뉴클레오타이드가 상보성에 의해 각 리드의 서열에 결합할 때마다 형광이 방출되고, 기계는 그 형광을 읽어 결과적으로 리드별 sequencing data를 기록한다 [(NGS sequencing에 대한 더 자세한 영상링크)](https://www.illumina.com/science/technology/next-generation-sequencing/plan-experiments/quality-scores.html).   

**이때 다양한 sequencing error가 발생할 수 있고, 기계는 그러한 오류율을 계산하여 읽은 서열의 품질로서 기록한다.** 품질이 떨어지는 일부 사례에 대한 [관련 링크](https://www.ecseq.com/support/ngs/why-does-the-sequence-quality-decrease-over-the-read-in-illumina)를 올려두었으니 도움이 되었으면 좋겠다.   

이러한 오류율을 "Quality score"라 한다. 즉 염기가 잘못 호출되어 읽힐 확률이다. 다음 표를 보자.  

|Phred Quality Score|Probability of incorrect base call|Base call accuracy|
|------|---|---|
|10|1 in 10|90%|
|20|1 in 100|99%|
|30|1 in 1000|99.9%|
|40|1 in 10000|99.99%|
|50|1 in 100000|99.999%|

여기서 어떤 하나의 염기에 대한 Phred Quality Score가 30이라면, 이는 오류율이 0.1% (정확도 99.9%)라는 것을 의미하고, 흔히 이 Phred Quality Score에 33을 더하여 ASCII code로 변환한 Sanger format을 이용하여 다음에 설명할 FASTQ 형식의 파일에 기록해둔다. 

---  

### 2. FASTQ  

FASTQ 형식의 파일은 너무도 잘 알려져 있기 때문에, 간단하게 아래 사진으로 정리해두었다.  

![Imgur](https://imgur.com/PkjlGhk.jpg)  

---