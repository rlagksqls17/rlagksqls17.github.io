---
title : "Leaf-GP: an open and automated software application for measuring growth phenotypes for arabidopsis and wheat"
excerpt : "ji Zhou et al., 2017, Plant Methods, 13-117"
categories:
  - Blog
layout: post
tags:
  - Blog
last_modified_at: 2021-01-22T08:11:00~13:00
---
작성중인 글입니다.

[원문 링크](https://plantmethods.biomedcentral.com/articles/10.1186/s13007-017-0266-3)  

원문을 한국어로 번역해서 요약한 후, 그에 대한 개인적인 고찰을 적도록 하겠다.
> 생소한 내용에 대한 설명은 이와 같은 형식으로 설명하겠다.

***  

## Abstract

#### Background

식물은 유전적, 환경적 요인으로 동적인 성장 표현형을 보여준다. 시간의 흐름에 따라 이뤄지는 특정 형질의 표현형 분석은 식물이 환경변화와 어떻게 상호작용하는지 이해하는데에 도움을 준다. 실험적 처리에 대한 식물의 반응처럼 말이다. 동적인 성장 형질을 측정하는 것의 중요성은 널리 인식되고 있지만, 측정을 가능하게 하는 오픈 소프트웨어 도구는 여러 측면(이미지 프로세싱, 다중 형질 분석, 소프트웨어 범용성, 표현형 분석의 자동화 문제)에서 제한되어 있다.

#### Results

Leaf_GP(Growth Phenotypes)를 소개한다. Leaf_GP는  사용하기 쉽고 다양한 컴퓨팅 플랫폼에서 실행될 수 있는 오픈 소프트웨어 애플리케이션이다. 다양한 과학적 커뮤니티를 촉진하기 위해, 우리는 세 개의 소프트웨어 버전(GUI for PC users, command-line interface for high performance computer, well-commented interactive jupyter notepbook)을 제공한다. 이 소프트웨어는 큰 이미지 데이터 셋으로부터 다중 성장 형질(multiple growth traits)을 추출할 수 있다. 우리는 Norwich Research Park(NRP, UK)의 성장 연구(애기장대와 밀)를 활용했다. 시간에 따른 성장 표현형을 정량화하기 위해, 우리는 몇몇 실험 조건하에서 서로 다른 유전자형 사이의 성장패턴들을 식별했다. Leaf-GP는 다양한 이미징 장치(스마트폰, 디지털카메라)로 획득한 노이즈 이미지 시리즈로 검사했고 계속적으로 안정적인 생물학적 출력을 나타냈다. 따라서 우리의 자동화 분석 워크플로우와, 추출 기능이 기반으로 되어 있는 맞춤형 소프트웨어의 구현이 식물의 성장과 발달 연구를 촉진 할 수 있다고 믿는다. 이 소프트웨어는 파이썬 컴퓨터 비전, 이미지 분석과 머신 러닝 라이브러리를 기반으로해서 구현했다. 따라서 우리의 소프트웨어는 생물학적 연구에 기여할 뿐만아니라 어떻게 numeric과 과학적 라이브러리를 활용하는지에 대한 방법도 보여줄 수 있다고 믿는다. 예를 들어 Scikit-image, OpenCV, Scipy 및 Scikit 학습은 효율적이고 효과적인 방법으로 안정적인 식물 현상학 분석 솔루션을 구축한다.

> 생물학적 연구 뿐만 아니라 코드 분석 연구의 효과로도 Leaf_GP 어플리케이션이 도움이 된다고 말하는 것 같다.

#### Conclusions

Leaf_GP는 대용량의 이미지 시리즈에서 성장 표현형을 정량화하는 세 가지 접근 방식을 제공하는 정교한 소프트웨어 응용 프로그램이다. 우리는 두 가지 생물학적 응용을 기반으로 그 유용성과 높은 정확성을 입증한다.

1. 두 가지 온도 조건에서 Arabidopsis 유전자형에 대한 성장 형질의 정량화

2. 시간에 따른 온실에서의 밀 성장 측정

이 소프트웨어는 사용하기 쉽고 Mac OS, Windows 및 HPC에서 실행할 수 있으며, 개방형 Python 기반 과학 라이브러리가 사전에 설치되어 있는 크로스 플랫폼이다.

우리의 작업은 식물의 현상을 컴퓨터 비전, 이미지 분석, 기계 학습으로 구현하는 발전된 방식을 보여준다. 식물 연구 커뮤니티에 서비스를 제공하기 위해 변형된 소스 코드, 자세한 설명, 실행 파일 및 실험 결과를 무료로 공개한다. https://github.com/Crop-Phenomics-Group/Leaf-GP/releases.

> **다음에 이 코드를 복사해서 사용해본 후 설명하도록 하겠다.**

## Background

식물은 유전적, 환경적 요인에 의해 결정되는 동적인 성장 표현형을 보여준다.

상대성장률(RGR, relative growth rates), 식물의 녹색성(greenness) 및 기타 형태학적 특성과 같은 표현형 특성은 식물이 환경 변화나 다양한 실험적 처리와 상호작용하는 방식을 정량화하기 위해 연구자들이 널리 사용한다.

특히 성장과 발달을 평가하기 위해 잎의 면적, 잎의 convex hull size 및 잎의 수가 식물 과학자들의 주요 측정치로 간주된다. 이 척도들은 실험 간에 형질과 관련된 성장의 차이를 측정치로 변환하는데 중요함을 나타낸다.

이러한 작업들을 수행하려면 시간이 지남에 따라 많은 생물학적 복제물에서 고품질 이미지 데이터를 수집해야한다. 그런 다음 수동, 반자동 또는 자동적으로 형질이 분석되는 방식이다.


> convex hull이 무엇인지 조사하였다. 다음 그림을 보자.

![convex](https://i.imgur.com/A6RAdMU.jpg)

> [여기서](https://www.semanticscholar.org/paper/IFS-fractal-morphing-based-on-coarse-convex-hull-Yi-xin-Yue-shan/a43bd29f3d14f6418d6f446ed3a4204be7be8eef/figure/3) 스크랩해온 것인데, 그림으로 미루어볼 때 아마도 잎의 형태를 벡터화해서, 수치적으로 표현하는 것이 아닐까 싶다.

그러나 증가하고 있는 이미지 기반 데이터에서 의미있는 결과를 효과적이고 효율적으로 추출하는 방법이 현재의 병목 현상이다. 동적인 성장 형질의 정량화를 용이하게 하기 위해 다양한 이미징 하드웨어 및 소프트웨어가 개발되었다. 이 연구 영역의 발전을 보여주기 위해 다음과 같이 몇 가지 대표적인 도구와 기술을 요약했다.

- LeafAnalyser는 각각의 잎을 자동적으로 기록해서 잎의 모양을 측정하는 이미지 프로세싱 기술이다.

- GROWSCREEN은 밝은 환경에서 동적인 씨앗의 성장을 정량화한다.

- GROWSCREEN FLUORO는 스트레스 내성을 감지하는 클로로필의 형광과 잎의 성장을 측정한다.

- LemnaGrid는 애기장대의 유전적 효과를 평가하기 위해 이미지 분석과 로제트 잎 영역 모델링을 통합한다.

> 로제트 잎은 애기장대가 성장할 때 나는 떡잎이 아닌 본옆을 뜻한다.

- Leaf Image Analysis Interface (LIMANI)는 애기장대 잎맥 패턴을 분할하고 계산한다.

- Rosette Tracker는 애기장대 유전형의 효과를 이해하는 것을 촉진하기 위해 plant-shoot phenotypes을 평가하는 자바 언어 기반 이미지 분석 솔루션을 제공한다.

- PhenoPhyte는 웹 기반 소프트웨어 애플리케이션을 통해 다양한 2D 잎 특성을 반 자동적으로 정량화한다.   

- Depth imaging systems은 세분화 알고리즘을 사용하여 3D 잎 영역을 측정하는 데 사용되어 식물을 평면도 관점에서 표현형화 할 수 있다.

- OSCLLATOR는 성숙한 식물에서 잎이 성장하면서 보이는 움직임을 분석한다.

- HPGA는 식물의 면적 추정 및 성장 모델링을 분석한다.

- LeafJ는 잎 모양 측정을 반 자동화하는 ImageJ 플러그인을 제공한다.

- IAP는 LemnaTec 시스템을 기반으로 식물 표현형 분석 작업을 수행하는 개방형 프레임 워크이다.

- Microsoft Kinect 및 David 레이저 스캐닝 시스템과 같은 저가형 3D 시스템은 식물 표현형에 대한 잠재적인 응용 분야를 검사한다.

- Easy Leaf Area는 색상 기반 기능을 사용하여 배경과 잎을 구별하고 측정한다.

- Phytotyping4D는 라이트 필드 카메라를 사용하여 초점과 깊이 이미지를 동시에 제공하여 잎 표면으로부터의 거리 정보를 정량화할 수 있다.

- LeasyScan은 잎 면적, 잎 면적 지수 및 증산작용을 기반으로 물 사용에 영향을 미치는 캐노피(canopy)특성을 평가할 수 있다.

- Leaf Angle Distribution Toolbox는 스테레오 이미지에서 3D 재구성을 통해 잎 표면 속성을 정량화하기 위한 Matlab 기반 소프트웨어 패키지이다.

- MorphoLeaf는 잎의 형태학적 특징을 분석한다.

- rosettR은 플레이트에서 자란 묘목의 전체 로제트 면적을 측정하기 위한 프로토콜이다.

- real-time machine learning based classification phenotyping framework는 잎 캐노피를 추출하여 삼각도를 평가할 수 있다(대두 식물).

- Phenotiki는 식물 표현형을 위한 시스템으로 Matlab 기반 소프트웨어를 통합한다.

많은 하드웨어 및 소프트웨어 솔루션이 만들어졌지만 이러한 기존 도구를 사용하여 성장 표현형을 측정하는 임계 값은 여전히 상대적으로 높다. 이는 특정 하드웨어 플랫폼이나 특수 소프트웨어 플랫폼에 의존해서, 규모가 작거나 자금이 부족하기 때문이다. 따라서 데이터 주석, 표현형 분석 및 결과 상호 참조는 여전히 많은 실험실에서 수동으로 수행되는 경우가 많으며 시간이 많이 걸리고 오류가 발생하기 쉽다. 또한 사용 가능한 개방형 소프트웨어 도구는 batch의 처리, 다중 특성 분석 및 소프트웨어 사용성 측면에서도 제한된 문제가 있다. 따라서 우리는 이러한 문제점을 해결한 완전 개방형 분석 소프트웨어 프레임 워크를 제공하기 위해 Leaf_GP를 개발했다. 이를 이용해 저비용 이미지 장치로 캡처한 이미지를 분석할 수 있다.

이 소프트웨어는 Python 기반 과학 및 숫자 라이브러리를 사용한다. 지속적인 개발 및 테스트 후 Leaf-GP는 이제 투영된 잎 면적, 잎 둘레, leaf convex 길이 및 넓이를 안정적으로 분석하여 성장 표현형을 추출하고 비교할 수 있다. 이 논문에서는 애기장대와 밀을 사용한 실험을 통해 높은 정확성과 유용성을 입증한다. 소프트웨어는 Python 및 Anaconda 배포가 사전 설치된 메인 스트림 운영 체제에서 실행할 수 있다. 더 중요한 것은 개방형 소프트웨어 설계 전략을 따랐다는 것이다. 이는 우리의 작업이 확장 가능하고 새로운 기능이나 모듈이 소프트웨어 프레임 워크에 쉽게 추가될 수 있음을 의미한다.

## Methods
#### Applying Leaf-GP to plant growth studies
그림 1은 Leaf_GP를 적용하여 시간이 지남에 따른 애기장대와 밀의 성장 표현형을 정량화하는 방법을 보여준다. 소프트웨어의 유연성을 향상시키기 위해 Leaf-GP는 다양한 저가형 장치에서 획득한 RGB 및 적외선 이미지를 모두 수용하도록 설계되었다. 또한 스마트폰, NoIR 센서나 RGP 센서가 장착된 CropQuant의 모바일 버전에서도 분석이 가능하다(그림 1a, 1b, 1c). 사진을 찍을 때, 사용자는 그림 1e 처럼 찍고자 하는 영역을 모두 덮도록 해야한다. 그리고 나서, 빨간색 원형 스티커를 화분의 네 모서리에 적용해야한다(그림 1b). 이렇게 하면 Leaf_GP는 빨간색 마커의 위치를 기반으로, 분석할 이미지에서 ROI 값을 추출한 다음 마커의 직경을 이미지의 배율로 사용하여 측정 값을 픽셀에서 미터단위로 변환할 수 있다. Raw데이터 및 전처리된 이미지 데이터는 개인용 컴퓨터, HPC 또는 클라우드 기반 컴퓨팅 스토리지에서 Leaf-GP로 로드 및 저장할 수 있다.

![fig1](https://i.imgur.com/IyOzGn6.jpg)

> 주피터 노트북으로도 설명용 파일을 만들었다는 것이 마음에 든다.

서로 다른 연구 그룹이 다른 기종으로 엑세스 할 수 있으므로 소프트웨어의 접근성을 높이기 위해 Leaf-GP의 세 가지 버전을 개발했다.

1. HPC 클러스터를 사용하는 사용자를 위해 Python 기반 스크립트로 높은 처리량 특성을 수행할 수 있도록 개발되었다. (그림 1h)

2. 데스크톱 PC에서 작업하는 사용자를 위해 배치(batch) 이미지 처리, 다중 특성 분석 및 결과 시각화(CSV 형식, 쉼표로 구분 된 값)를 사용자 친화적인 창에 통합하기 위해 GUI 기반 소프트웨어 버전이 개발되었다.(그림 1i)

3. 우리의 소스 코드를 이용하려는 컴퓨터 과학자들을 위해 우리는 소프트웨어 구현 뿐만 아니라 특성 분석 워크 플로우를 설명하기 위해 대화형 주피터 노트북(그림 1j)을 만들었다. 특히, 우리는 노트북 버전이 주피터 서버를 통해 큰 이미지 시리즈를 처리할 수 있도록 했다. 이는 사용자가 노트북 버전을 사용하여 직접 단계적 알고리즘 실행 및 이미지 일괄 처리를 수행할 수 있음을 의미한다. 소프트웨어 배포 라이선스 문제로 인해 사용자는 Leaf_GP를 사용하기 전에 Anaconda Python 배포 (Python 2.7 버전) 및 OpenCV(v2.4.11)라이브러리를 설치하는 것이 좋다. Leaf-GP를 패키징하기 위해 Pyinstaller를 사용했다. Additional file 2는 Python 및 소프트웨어에 필요한 라이브러리를 설치하는 방법에 대한 단계별 절차를 설명한다.
