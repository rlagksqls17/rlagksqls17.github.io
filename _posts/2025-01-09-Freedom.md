---
layout: post
title: "[통계] 왜 표본 분산을 추정할 때 자유도 n-1을 사용할까?"
categories: project
tags: test
last_modified_at: 2025-01-09T18:00:00~23:00
---  


<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/Tex", "ourput/HTML-CSS"],
        tex2jax: {
            inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
            displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
            processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
    });
</script>


## 출처: 데이터 분석을 위한 통계 (Bruce P. & Bruce A., 2021)  
여태 데이터 분석 업무 수행 시, 궁금한 점이 있어도 그냥 그런가 보다하고 넘어가며 공부해 왔던 것 같아서, 특정 궁금증 해결 과정을 정리해보았다. 위 책 내용을 일부 참조하였다.  


## 왜 표본 분산을 추정할 때 자유도 n-1을 사용할까?   
분산 (variance)은 관측값에서 평균을 뺀 값을 제곱하고, 그것을 모두 더한 후 전체 개수로 나눠서 구한다. 관측값에서 평균을 뺀 값인 편차를 모두 더하면 0이 나오므로 제곱해서 더한다.   

즉, 
$$\sigma = \frac{1}{n} \sum_{i=1}^{n}(x_i - \mu)^2$$    

다만 위 식은 모집단을 가정할 경우에 구하는 분산의 식이다. 일반적으로 임상적 데이터 분석 시 모집단을 모두 샘플링 하는 것은 거의 불가능하다고 보면 된다 (우리나라 국민 전체의 백혈구 수치를 분석해본다고 생각해보자).   

모집단의 일부, 즉 표본을 샘플링해서 그에 대한 통계량을 추정하는 것이 생물학에서는 가장 일반적인 방식이고, 따라서 많은 통계적인 모델에서 표본 평균과 표본 분산을 구하는 일이 비일비재하다.  

표본분산의 경우, 모집단의 분산에서와 달리 샘플의 개수로 나누지 않고, 자유도 개념을 도입해서 (샘플의 개수 - 1)로 나누어준다. 자유도의 개념은 많은 사이트에서 다루지만, 개념 자체의 표현이 모호하고 설명과 설명사이의 연결고리가 불충분하다고 생각하여 본인에게는 그렇게 와닿도록 이해가 되지는 않았다. 따라서 방정식 풀이를 통해서 왜 하필 N이 아니라 N-1로 나누어야 하는지에 대한 기록을 하려고 한다.  

---  

우선, 표본분산을 구하는 식은 다음과 같다. 여기서 $\mu$ 는 모집단의 평균이고, $n$ 은 샘플의 수이다.

$$\sigma = \frac{1}{n-1} \sum_{i=1}^{n}(x_i - \mu)^2$$  

먼저 여기서부터, 정말로 n-1로 나누는 것이 맞지 않다고 가정을 해보자. 그렇다면 표본분산을 구하는 식은 위 방정식이 아니라 아래의 방정식이 되어야 한다. 표본평균의 기호 $\bar x$만 표기되었을 뿐이지 모집단의 분산을 구하는 방식과 똑같다.  

$$\sigma = \frac{1}{n} \sum_{i=1}^{n}(x_i - \bar x)^2$$  

일단 위 식에서 1/n은 나중에 생각하기로하고 배제한다.   
우선 식 내부의 $x_i - \bar x = (x_i - \mu) - (\bar x - \mu)$ 이다.  
즉 $(x_i - \bar x)^2 = [(x_i - \mu) - (\bar x - \mu)]^2$,  
위 식을 전개하면, $(x_i - \bar x)^2 = (x_i - \mu)^2 - 2(x_i - \mu)(\bar x - \mu) + (\bar x - \mu)^2$,  
이후 모든 i에 대해 합을 취하면,   

$$\sum_{i=1}^{n}(x_i - \bar x)^2 = \sum_{i=1}^{n}(x_i - \mu)^2 - \sum_{i=1}^{n}2(x_i - \mu)(\bar x - \mu) + \sum_{i=1}^{n}(\bar x - \mu)^2$$  
